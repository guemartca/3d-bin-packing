!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("BinPacking",[],e):"object"==typeof exports?exports.BinPacking=e():t.BinPacking=e()}(this,(function(){return function(){"use strict";var t={133:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var o=i(138),n=(0,i(788).createLogger)("3D:"),r=function(){function t(t,e,i,n,r){void 0===r&&(r=0),this.name="",this.width=0,this.height=0,this.depth=0,this.maxWeight=0,this.items=[],this.name=t,this.width=(0,o.factoredInteger)(e),this.height=(0,o.factoredInteger)(i),this.depth=(0,o.factoredInteger)(n),this.maxWeight=(0,o.factoredInteger)(r)}return t.prototype.getName=function(){return this.name},t.prototype.getWidth=function(){return(0,o.unfactorInteger)(this.width)},t.prototype.getHeight=function(){return(0,o.unfactorInteger)(this.height)},t.prototype.getDepth=function(){return(0,o.unfactorInteger)(this.depth)},t.prototype.getMaxWeight=function(){return(0,o.unfactorInteger)(this.maxWeight)},t.prototype.getItems=function(){return this.items},t.prototype.getVolume=function(){return this.getWidth()*this.getHeight()*this.getDepth()},t.prototype.getPackedWeight=function(){var t=this.items.reduce((function(t,e){return t+e.weight}),0);return(0,o.unfactorInteger)(t)},t.prototype.getPackedVolume=function(){for(var t=0,e=0,i=this.items;e<i.length;e++)t+=i[e].getVolume();return t},t.prototype.weighItem=function(t){return!this.maxWeight||t.weight+this.getPackedWeight()<=this.maxWeight},t.prototype.scoreRotation=function(t,e){t.rotationType=e;var i=t.getDimension();return this.getWidth()<i[0]||this.getHeight()<i[1]||this.getDepth()<i[2]?0:Math.pow(i[0]/this.getWidth(),2)+Math.pow(i[1]/this.getHeight(),2)+Math.pow(i[2]/this.getDepth(),2)},t.prototype.getBestRotationOrder=function(t){for(var e={},i=0;i<t.allowedRotation.length;i++){var o=t.allowedRotation[i];e[o]=this.scoreRotation(t,o)}return Object.keys(e).sort((function(t,i){return e[Number(i)]-e[Number(t)]})).map(Number)},t.prototype.putItem=function(t,e){var i=this,o=!1,r=this.getBestRotationOrder(t);t.position=e;for(var s=0;s<r.length;s++){t.rotationType=r[s];var h=t.getDimension();if(i.getWidth()<e[0]+h[0]||i.getHeight()<e[1]+h[1]||i.getDepth()<e[2]+h[2])o=!1;else{o=!0;for(var a=0;a<i.items.length;a++)if(i.items[a].intersect(t)){o=!1;break}o&&i.items.push(t)}if(n("try to putItem",o,"item",t.toString(),"box",i.toString()),o)break}return o},t.prototype.toString=function(){return"Bin:".concat(this.name," (WxHxD = ").concat(this.getWidth(),"x").concat(this.getHeight(),"x").concat(this.getDepth(),", MaxWg. = ").concat(this.getMaxWeight(),")")},t}();e.default=r},138:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.unfactorInteger=e.factoredInteger=void 0,e.factoredInteger=function(t){return Math.round(t*Math.pow(10,2))},e.unfactorInteger=function(t){return t/Math.pow(10,2)}},260:function(t,e,i){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Packer=e.Item=e.Bin=void 0;var n=o(i(133));e.Bin=n.default;var r=o(i(313));e.Item=r.default;var s=o(i(708));e.Packer=s.default},313:function(t,e,i){var o;Object.defineProperty(e,"__esModule",{value:!0}),e.rectIntersect=e.RotationTypeStrings=e.StartPosition=e.DepthAxis=e.HeightAxis=e.WidthAxis=e.RotationType_WDH=e.RotationType_DWH=e.RotationType_DHW=e.RotationType_HDW=e.RotationType_HWD=e.RotationType_WHD=void 0;var n=i(138);e.RotationType_WHD=0,e.RotationType_HWD=1,e.RotationType_HDW=2,e.RotationType_DHW=3,e.RotationType_DWH=4,e.RotationType_WDH=5,e.WidthAxis=0,e.HeightAxis=1,e.DepthAxis=2,e.StartPosition=[0,0,0],e.RotationTypeStrings=((o={})[e.RotationType_WHD]="RotationType_WHD (w,h,d)",o[e.RotationType_HWD]="RotationType_HWD (h,w,d)",o[e.RotationType_HDW]="RotationType_HDW (h,d,w)",o[e.RotationType_DHW]="RotationType_DHW (d,h,w)",o[e.RotationType_DWH]="RotationType_DWH (d,w,h)",o[e.RotationType_WDH]="RotationType_WDH (w,d,h)",o);var r=function(){function t(t,i,o,r,s,h){void 0===s&&(s=0),this.name="",this.width=0,this.height=0,this.depth=0,this.weight=0,this.allowedRotation=[0,1,2,3,4,5],this.rotationType=e.RotationType_WHD,this.position=[0,0,0],this.name=t,this.width=(0,n.factoredInteger)(i),this.height=(0,n.factoredInteger)(o),this.depth=(0,n.factoredInteger)(r),this.weight=(0,n.factoredInteger)(s),this.allowedRotation=h||this.allowedRotation}return t.prototype.getWidth=function(){return(0,n.unfactorInteger)(this.width)},t.prototype.getHeight=function(){return(0,n.unfactorInteger)(this.height)},t.prototype.getDepth=function(){return(0,n.unfactorInteger)(this.depth)},t.prototype.getWeight=function(){return(0,n.unfactorInteger)(this.weight)},t.prototype.getRotationType=function(){return this.rotationType},t.prototype.getAllowedRotation=function(){return this.allowedRotation},t.prototype.getRotationTypeString=function(){return e.RotationTypeStrings[this.getRotationType()]},t.prototype.getDimension=function(){var t;switch(this.rotationType){case e.RotationType_WHD:t=[this.getWidth(),this.getHeight(),this.getDepth()];break;case e.RotationType_HWD:t=[this.getHeight(),this.getWidth(),this.getDepth()];break;case e.RotationType_HDW:t=[this.getHeight(),this.getDepth(),this.getWidth()];break;case e.RotationType_DHW:t=[this.getDepth(),this.getHeight(),this.getWidth()];break;case e.RotationType_DWH:t=[this.getDepth(),this.getWidth(),this.getHeight()];break;case e.RotationType_WDH:t=[this.getWidth(),this.getDepth(),this.getHeight()]}return t},t.prototype.getPosition=function(){return[(0,n.unfactorInteger)(this.position[0]),(0,n.unfactorInteger)(this.position[1]),(0,n.unfactorInteger)(this.position[2])]},t.prototype.intersect=function(t){return(0,e.rectIntersect)(this,t,e.WidthAxis,e.HeightAxis)&&(0,e.rectIntersect)(this,t,e.HeightAxis,e.DepthAxis)&&(0,e.rectIntersect)(this,t,e.WidthAxis,e.DepthAxis)},t.prototype.getVolume=function(){return this.getWidth()*this.getHeight()*this.getDepth()},t.prototype.toString=function(){return"Item:".concat(this.name," (").concat(this.getRotationTypeString()," = ").concat(this.getDimension().join("x"),", Wg. = ").concat(this.getWeight(),")")},t}();e.default=r,e.rectIntersect=function(t,e,i,o){var n,r,s,h,a,u,p,g;return n=t.getDimension(),r=e.getDimension(),s=t.position[i]+n[i]/2,h=t.position[o]+n[o]/2,a=e.position[i]+r[i]/2,u=e.position[o]+r[o]/2,p=Math.max(s,a)-Math.min(s,a),g=Math.max(h,u)-Math.min(h,u),p<(n[i]+r[i])/2&&g<(n[o]+r[o])/2}},618:function(t,e,i){var o,n=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,o,n)}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||(o=function(t){return o=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},o(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=o(t),s=0;s<i.length;s++)"default"!==i[s]&&n(e,t,i[s]);return r(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.BP3D=void 0;var h=s(i(260));e.BP3D=h},708:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var o=i(313),n=function(){function t(){this.bins=[],this.items=[],this.unfitItems=[]}return t.prototype.addBin=function(t){this.bins.push(t)},t.prototype.addItem=function(t){this.items.push(t)},t.prototype.findFittedBin=function(t){for(var e=0;e<this.bins.length;e++){var i=this.bins[e];if(i.weighItem(t)&&i.putItem(t,o.StartPosition))return 1===i.items.length&&i.items[0]===t&&(i.items=[]),i}return null},t.prototype.getBiggerBinThan=function(t){for(var e=t.getVolume(),i=0;i<this.bins.length;i++){var o=this.bins[i];if(o.getVolume()>e)return o}return null},t.prototype.unfitItem=function(){0!==this.items.length&&(this.unfitItems.push(this.items[0]),this.items.splice(0,1))},t.prototype.packToBin=function(t,e){var i=null,n=[];if(!t.weighItem(e[0])||!t.putItem(e[0],o.StartPosition)){var r=this.getBiggerBinThan(t);return r?this.packToBin(r,e):this.items}for(var s=1;s<this.items.length;s++){var h=!1,a=this.items[s];if(t.weighItem(a))t:for(var u=0;u<3;u++)for(var p=0;p<t.items.length;p++){var g=void 0,c=t.items[p],f=c.getDimension();switch(u){case o.WidthAxis:g=[c.position[0]+f[0],c.position[1],c.position[2]];break;case o.HeightAxis:g=[c.position[0],c.position[1]+f[1],c.position[2]];break;case o.DepthAxis:g=[c.position[0],c.position[1],c.position[2]+f[2]]}if(t.putItem(a,g)){h=!0;break t}}if(!h){for(;null!==i;)if((i=this.getBiggerBinThan(t))&&(i.items.push(a),0===this.packToBin(i,i.items).length)){t=i,h=!0;break}h||n.push(a)}}return n},t.prototype.pack=function(){for(this.bins.sort((function(t,e){return t.getVolume()-e.getVolume()})),this.items.sort((function(t,e){return e.getVolume()-t.getVolume()}));this.items.length>0;){var t=this.findFittedBin(this.items[0]);null!==t?this.items=this.packToBin(t,this.items):this.unfitItem()}return null},t}();e.default=n},788:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.enableLog=function(t){void 0===t&&(t=!0),i=t},e.createLogger=function(t){return void 0===t&&(t="binpackingjs"),o.bind(void 0,t)},e.log=o;var i=!1;function o(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return i?console.debug.apply(console,[t].concat(e)):void 0}}},e={};return function i(o){var n=e[o];if(void 0!==n)return n.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,i),r.exports}(618)}()}));